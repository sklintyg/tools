---
# file: roles/apache-vhost/tasks/main.yml

- name: Fix ssl.conf _default_ vhost
  when: ansible_os_family == "RedHat"
  lineinfile:
    dest="/etc/httpd/conf.d/ssl.conf"
    regexp="<VirtualHost .*:443>"
    line="<VirtualHost 127.0.0.1:443>"

- name: Make apache logs accessible to wheel group
  when: ansible_os_family == "RedHat"
  file: path=/var/log/httpd mode=0750 group=wheel

- name: Allow httpd to initiate network connection to tomcat
  when: ansible_os_family == "RedHat" and environment_name != "dev"
  command: "/usr/sbin/setsebool -P httpd_can_network_connect 1"
